{% extends "layout.html" %}

{% block title %}Reset Password{% endblock %}

{% block content %}

<h2>Reset Password</h2>

{% for message in get_flashed_messages() %}
<p class="info">
  {{ message }}
</p>
{% endfor %}

<!-- VULNERABLE: Token in form field, not URL -->
<form action="/reset_password" method="post">
  <p>
    <label for="token">Reset Token:</label><br />
    <input type="text" id="token" name="token" required />
    <small>(Check your messages after requesting reset)</small>
  </p>
  <p>
    <label for="new_password">New Password:</label><br />
    <input type="password" id="new_password" name="new_password" required />
  </p>
  <p>
    <label for="confirm_password">Confirm Password:</label><br />
    <input type="password" id="confirm_password" name="confirm_password" required />
  </p>
  <input type="submit" value="Reset Password" />
</form>

<p><a href="{{ url_for('forgot_password') }}">Request new reset token</a></p>

{% endblock %}
